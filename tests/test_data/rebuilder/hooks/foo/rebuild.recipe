!rebuild.recipe!

package foo 1.0.0
  steps
    step_setup

    step_shell
      cmd: mkdir -p ${REBUILD_STAGE_BIN_DIR}

    step_shell
      cmd: install -m 755 ${REBUILD_RECIPE_DIR}/foo.py ${REBUILD_STAGE_BIN_DIR}/foo.py

    step_post_install
      tests
        all: test-foo.sh
        
      skip_binary_third_party_prefix: True

      post_install_hooks
        all: _test_hook1
          class _test_hook1(hook):
            def execute(self, script, env):
              import os.path as path
              from bes.fs import file_replace
              f = path.join(script.staged_files_bin_dir, 'foo.py')
              file_replace.replace(f, { '@FOO@': 'hook1' }, word_boundary = True)
              return self.result(True)
        all: _test_hook2
          class _test_hook2(hook):
            def execute(self, script, env):
              import os.path as path
              from bes.fs import file_replace
              f = path.join(script.staged_files_bin_dir, 'foo.py')
              file_replace.replace(f, { '@BAR@': 'hook2' }, word_boundary = True)
              return self.result(True)
